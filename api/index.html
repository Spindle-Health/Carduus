
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../CarduusDatabricksDemo/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.2">
    
    
      
        <title>API - Carduus</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Carduus" class="md-header__button md-logo" aria-label="Carduus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Carduus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="deep-purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Carduus" class="md-nav__button md-logo" aria-label="Carduus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Carduus
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#carduus.token.tokenize" class="md-nav__link">
    <span class="md-ellipsis">
      tokenize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.transcrypt_out" class="md-nav__link">
    <span class="md-ellipsis">
      transcrypt_out
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.transcrypt_in" class="md-nav__link">
    <span class="md-ellipsis">
      transcrypt_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.TokenInfo" class="md-nav__link">
    <span class="md-ellipsis">
      TokenInfo
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CarduusDatabricksDemo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databricks
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OPPRL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            OPPRL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opprl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opprl/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opprl/contrib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Project
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Project
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of Conduct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#carduus.token.tokenize" class="md-nav__link">
    <span class="md-ellipsis">
      tokenize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.transcrypt_out" class="md-nav__link">
    <span class="md-ellipsis">
      transcrypt_out
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.transcrypt_in" class="md-nav__link">
    <span class="md-ellipsis">
      transcrypt_in
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#carduus.token.TokenInfo" class="md-nav__link">
    <span class="md-ellipsis">
      TokenInfo
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="functions">Functions</h1>



<div class="doc doc-object doc-function">



<h2 id="carduus.token.tokenize" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">carduus.token.tokenize</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">tokenize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pii_transforms</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">key_service</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Replaces all PII attributes with encrypted tokens.</p>
<p>All PII columns found in the <code>DataFrame</code> are normalized using the provided <code>pii_transforms</code>.
All PII attributes provided by the enhancements of the <code>pii_transforms</code> are added if they
are not already present in the <code>DataFrame</code>. The fields of each <a class="autorefs autorefs-internal" href="#carduus.token.TokenInfo"><code>TokenInfo</code></a>
from <code>tokens</code> are hashed and encrypted together according to the OPPRL specification. Finally,
the PII columns are dropped.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>df</code></td>
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pyspark <code>DataFrame</code> containing all PII attribures.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>pii_transforms</code></td>
          <td>
                <code>dict[str, <a class="autorefs autorefs-internal" title="carduus.token.pii.PiiTransform" href="#carduus.token.PiiTransform">PiiTransform</a> | <a class="autorefs autorefs-internal" title="carduus.token.OpprlPii" href="#carduus.token.OpprlPii">OpprlPii</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary that maps column names of <code>df</code> to <a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a>
objects to specify how each raw PII column is normalized and enhanced into derived PII attributes.
Values can also be a member of the <a class="autorefs autorefs-internal" href="#carduus.token.OpprlPii">OpprlPii</a> enum if using the
standard OPPRL tokens.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>tokens</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="carduus.token.TokenInfo" href="#carduus.token.TokenInfo">TokenInfo</a> | <a class="autorefs autorefs-internal" title="carduus.token.OpprlToken" href="#carduus.token.OpprlToken">OpprlToken</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A collection of <a class="autorefs autorefs-internal" href="#carduus.token.TokenInfo"><code>TokenInfo</code></a> objects that denotes which PII attibutes
are encrypted into each token. Elements can also be a member of the <a class="autorefs autorefs-internal" href="#carduus.token.OpprlToken">OpprlToken</a>
enum if using the standard OPPRL tokens.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>key_service</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="carduus.keys.EncryptionKeyService" href="#carduus.keys.EncryptionKeyService">EncryptionKeyService</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An optional <a class="autorefs autorefs-internal" href="#carduus.keys.EncryptionKeyService"><code>EncryptionKeyService</code></a> instance that serves your private
keys and the public keys of the parties you exchange data with. Default is an instance of
<a class="autorefs autorefs-internal" href="#carduus.keys.SparkConfKeyService"><code>SparkConfKeyService</code></a> which looks for encryption keys loaded as
spark configuration properties.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>DataFrame</code> with PII columns replaced by encrypted tokens.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="carduus.token.transcrypt_out" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">carduus.token.transcrypt_out</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">transcrypt_out</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">token_columns</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">key_service</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Prepares a <code>DataFrame</code> containing encrypted tokens to be sent to a specific trusted party by re-encrypting
the tokens using the recipient's public key without exposing the original PII.</p>
<p>Output tokens will be unmatchable to any dataset or within the given dataset until the intended receipient
processes the data with []<code>transcrypt_in</code>][carduus.token.transcrypt_in].</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>df</code></td>
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spark <code>DataFrame</code> with token columns to transcrypt.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>token_columns</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The collection of column names that correspond to tokens.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>destination</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the destination that will be receiving transcrypted data. Used to lookup the appropriate
public keys for asymmetric encryption.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>key_service</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="carduus.keys.EncryptionKeyService" href="#carduus.keys.EncryptionKeyService">EncryptionKeyService</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An optional <a class="autorefs autorefs-internal" href="#carduus.keys.EncryptionKeyService"><code>EncryptionKeyService</code></a> instance that serves your private
keys and the public keys of the parties you exchange data with. Default is an instance of
<a class="autorefs autorefs-internal" href="#carduus.keys.SparkConfKeyService"><code>SparkConfKeyService</code></a> which looks for encryption keys loaded as
spark configuration properties.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>DataFrame</code> with the origional encrypted tokens re-encrypted for sending to the destination.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="carduus.token.transcrypt_in" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">carduus.token.transcrypt_in</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">transcrypt_in</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">token_columns</span><span class="p">,</span> <span class="n">key_service</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Used by the recipient of a <code>DataFrame</code> containing tokens in the intermediate representation produced by
<a class="autorefs autorefs-internal" href="#carduus.token.transcrypt_out"><code>transcrypt_out</code></a> to re-encrypt the tokens such that they will match with
other datasets</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>df</code></td>
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Spark <code>DataFrame</code> with token columns to transcrypt.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>token_columns</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The collection of column names that correspond to tokens.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>key_service</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="carduus.keys.EncryptionKeyService" href="#carduus.keys.EncryptionKeyService">EncryptionKeyService</a> | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An optional <a class="autorefs autorefs-internal" href="#carduus.keys.EncryptionKeyService"><code>EncryptionKeyService</code></a> instance that serves your private
keys and the public keys of the parties you exchange data with. Default is an instance of
<a class="autorefs autorefs-internal" href="#carduus.keys.SparkConfKeyService"><code>SparkConfKeyService</code></a> which looks for encryption keys loaded as
spark configuration properties.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The <code>DataFrame</code> with the origional encrypted tokens re-encrypted for sending to the destination.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="carduus.token.TokenInfo" class="doc doc-heading">
          <code>carduus.token.TokenInfo</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


  <div class="doc doc-contents first">

  
      <p>An ordered set of PII fields that will be encrypted together to create a token.</p>
<p>For an enum of standard <code>TokenInfo</code> instances that comply with the Open Privacy Preserving Record Linkage specification
see <a class="autorefs autorefs-internal" href="#carduus.token.OpprlToken"><code>OpprlToken</code></a>.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.TokenInfo.name">name</span></code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column that holds these tokens.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.TokenInfo.fields">fields</span></code></td>
          <td>
                <code>tuple[str, ...]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The PII fields to encrypt together to create token values.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div><h1 id="opprl-implementation">OPPRL Implementation</h1>
<p>Carduus is an extensible framework for implementing tokenization and record linkage systems, that also provides
an implementation of the Open Privacy Preserving Record Linkage protocol. </p>


<div class="doc doc-object doc-class">



<h2 id="carduus.token.OpprlPii" class="doc doc-heading">
          <code>carduus.token.OpprlPii</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum of <a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> objects for the PII fields supported by the Open Privacy Preserving
Record Linkage specification.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlPii.first_name">first_name</span></code></td>
          <td>
                <code><span title="carduus.token.pii.NameTransform">NameTransform</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> implementation for a subject's first name according to the OPPRL standard.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlPii.middle_name">middle_name</span></code></td>
          <td>
                <code><span title="carduus.token.pii.NameTransform">NameTransform</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> implementation for a subject's middle name according to the OPPRL standard.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlPii.last_name">last_name</span></code></td>
          <td>
                <code><span title="carduus.token.pii.NameTransform">NameTransform</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> implementation for a subject's last (aka family) name according to the OPPRL standard.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlPii.gender">gender</span></code></td>
          <td>
                <code><span title="carduus.token.pii.GenderTransform">GenderTransform</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> implementation for a subject's gender according to the OPPRL standard.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlPii.birth_date">birth_date</span></code></td>
          <td>
                <code><span title="carduus.token.pii.DateTransform">DateTransform</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> implementation for a subject's date of birth according to the OPPRL standard.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="carduus.token.OpprlToken" class="doc doc-heading">
          <code>carduus.token.OpprlToken</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum of <a class="autorefs autorefs-internal" href="#carduus.token.TokenInfo"><code>TokenInfo</code></a> objects that meet the Open Privacy Preserving
Record Linkage tokenization specification.</p>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlToken.token1">token1</span></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="carduus.token.TokenInfo" href="#carduus.token.TokenInfo">TokenInfo</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard Carduus token #1. Creates tokens based on <code>first_initial</code>, <code>last_name</code>, <code>gender</code>, and <code>birth_date</code>.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><span title="carduus.token.OpprlToken.token2">token2</span></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="carduus.token.TokenInfo" href="#carduus.token.TokenInfo">TokenInfo</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Standard Carduus token #2. Creates tokens based on <code>first_soundex</code>, <code>last_soundex</code>, <code>gender</code>, and <code>birth_date</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>


  

  <div class="doc doc-children">











  </div>

  </div>


</div><h1 id="encryption-key-management">Encryption Key Management</h1>
<p>Carduus provides</p>


<div class="doc doc-object doc-class">



<h2 id="carduus.keys.SparkConfKeyService" class="doc doc-heading">
          <code>carduus.keys.SparkConfKeyService</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="carduus.keys.EncryptionKeyService" href="#carduus.keys.EncryptionKeyService">EncryptionKeyService</a></code></p>



  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="carduus.keys.InMemoryKeyService" class="doc doc-heading">
          <code>carduus.keys.InMemoryKeyService</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="carduus.keys.EncryptionKeyService" href="#carduus.keys.EncryptionKeyService">EncryptionKeyService</a></code></p>



  

  <div class="doc doc-children">











  </div>

  </div>


</div><h1 id="interfaces">Interfaces</h1>
<p>Carduus offers interfaces that can be extended by the user to add additional behaviors to the tokenization process.</p>
<p>The primary extention </p>


<div class="doc doc-object doc-class">



<h2 id="carduus.token.PiiTransform" class="doc doc-heading">
          <code>carduus.token.PiiTransform</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Abstract base class for normalization and enhancement of a specific PII attribute.</p>
<p>Intended to be extended by users to add support for building tokens from a custom PII attribute.</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="carduus.token.PiiTransform.normalize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">normalize</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A normalized representation of the PII column.</p>
<p>A normalized value has eliminated all representation or encoding differences so all instances of the
same logical values have identical physical values. For example, text attributes will often be normalized
by filtering to alpha-numeric characters and whitespace, standardizing to whitespace to the space character,
and converting all alpha characters to uppercase to ensure that all ways of representing the same phrase
normalize to the exact same string.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>column</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spark <code>Column</code> expression for the PII attribute being normalized.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>dtype</code></td>
          <td>
                <code><span title="pyspark.sql.types.DataType">DataType</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The spark <code>DataType</code> object of the <code>column</code> object found on the <code>DataFrame</code> being normalized.
Can be used to delegate to different normalization logic based on different schemas of input data.
For example, a subject's birth date may be a <code>DateType</code>, <code>StringType</code>, or <code>LongType</code> on input data and
thus requires corresponding normalization into a <code>DateType</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The normalized version of the PII attribute.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="carduus.token.PiiTransform.enhancments" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">enhancments</span><span class="p">(</span><span class="n">column</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A collection of PII attributes that can be automatically derived from a given normalized PII attribute</p>
<p>If an implementation of <a class="autorefs autorefs-internal" href="#carduus.token.PiiTransform">PiiTransform</a> does not override this method, it is
assumed that no enhancements can be derived</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>column</code></td>
          <td>
                <code><span title="pyspark.sql.Column">Column</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The normalized PII column to produce enhancements from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<details class="return" open>
  <summary>Return</summary>
  <p>A <code>dict</code> with keys that correspond to the PII attributes of the ___ and values that correspond to the <code>Column</code>
expression that produced the new PII from a normalized input attribute.</p>
</details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="carduus.keys.EncryptionKeyService" class="doc doc-heading">
          <code>carduus.keys.EncryptionKeyService</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Abstract base class for key services. Can be implemented to call out whichever
service you use to manage encryption keys.</p>


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="carduus.keys.EncryptionKeyService.private_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">private_key</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Provides your private key.</p>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="carduus.keys.EncryptionKeyService.public_key_of" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">public_key_of</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Provides the public key of a specific profiles (aka partner) that you share data with.</p>

  </div>

</div>



  </div>

  </div>


</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>